<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Google Sheets API Example</title>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        function initClient() {
            gapi.client.init({
                'apiKey': 'YOUR_API_KEY',
                'clientId': 'YOUR_CLIENT_ID',
                'scope': 'https://www.googleapis.com/auth/spreadsheets',
                'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
            }).then(function () {
                // Handle successful initialization
            }, function(error) {
                console.log(JSON.stringify(error, null, 2));
            });
        }

        gapi.load('client:auth2', initClient);

        function handleSignInClick(event) {
            gapi.auth2.getAuthInstance().signIn();
        }

        function handleSignOutClick(event) {
            gapi.auth2.getAuthInstance().signOut();
        }

        function readSheetData() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: 'YOUR_SPREADSHEET_ID',
                range: 'Sheet1!A1:E10',
            }).then(function(response) {
                var range = response.result;
                console.log(range);
                // Handle the response data
            }, function(error) {
                console.error('Error: ' + error.result.error.message);
            });
        }

        function writeSheetData(values) {
            var params = {
                spreadsheetId: 'YOUR_SPREADSHEET_ID',
                range: 'Sheet1!A1',
                valueInputOption: 'RAW',
            };

            var valueRangeBody = {
                "values": values,
            };

            var request = gapi.client.sheets.spreadsheets.values.update(params, valueRangeBody);
            request.then(function(response) {
                console.log(response.result);
                // Handle the response data
            }, function(error) {
                console.error('Error: ' + error.result.error.message);
            });
        }
    </script>
</head>
<body>
    <button onclick="handleSignInClick()">Sign In</button>
    <button onclick="handleSignOutClick()">Sign Out</button>
    <button onclick="readSheetData()">Read Data</button>
    <button onclick="writeSheetData([['Data1', 'Data2', 'Data3']])">Write Data</button>
</body>
</html>
